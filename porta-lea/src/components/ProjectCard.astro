---
// src/components/ProjectCard.astro
interface Props {
  project: {
    id: string;
    title: string;
    image: string;
    technologies: string[];
    githubUrl?: string; 
    demoUrl?: string;   
    description?: string;
    category?: string; // AÃ±adido para mostrar el origen del archivo
  };
}

const { project } = Astro.props;
const hasLinks = project.githubUrl || project.demoUrl;
---

<article class="flex flex-col h-full relative group w-full max-w-full">
  <div class="flex items-end ml-1 w-full overflow-hidden">
    <div class="bg-[#403b33] text-[#e7e2d8] text-[9px] md:text-[10px] font-bold px-3 py-1.5 uppercase tracking-widest border-t-2 border-x-2 border-black rounded-t-lg relative z-10 truncate max-w-[85%]">
      {project.category === 'profesional' ? '' : ''}{project.id}
    </div>
    <div class="h-0.5 bg-black flex-grow mb-0.5 opacity-20"></div>
  </div>

  <div class="flex flex-col h-full bg-[#d1ccbd] border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(64,59,51,0.4)] transition-all duration-300 group-hover:shadow-[8px_8px_0px_0px_rgba(64,59,51,1)] group-hover:-translate-y-1 relative overflow-hidden w-full">
    
    <div class="p-3">
      <div class="relative h-40 md:h-48 border-2 border-black overflow-hidden bg-black">
        <img
          src={project.image}
          alt={`Miniatura del proyecto ${project.title}`}
          class="w-full h-full object-cover grayscale opacity-80 group-hover:grayscale-0 group-hover:opacity-100 transition-all duration-700"
          loading="lazy"
        />
        <div class="absolute inset-0 pointer-events-none bg-gradient-to-tr from-transparent via-white/5 to-white/10 opacity-30"></div>
      </div>
    </div>

    <div class="p-4 md:p-5 pt-2 flex-grow flex flex-col">
      <div class="flex items-center gap-2 mb-3 min-w-0">
        <div class={`w-2 h-2 rounded-full animate-pulse flex-shrink-0 ${project.category === 'profesional' ? 'bg-[#e85a4f]' : 'bg-[#403b33]'}`}></div>
        <h3 class="text-lg md:text-xl font-black text-[#403b33] font-mono leading-tight uppercase truncate">
          {project.title}
        </h3>
      </div>

      {project.description && (
        <p class="text-[10px] md:text-[11px] text-[#403b33]/70 font-mono mb-6 line-clamp-2 italic leading-relaxed border-l-2 border-[#403b33]/30 pl-3">
          // {project.description}
        </p>
      )}

      <div class="flex flex-wrap gap-1.5 mb-8">
        {project.technologies.map(tech => (
          <span class="text-[8px] md:text-[9px] uppercase font-bold px-2 py-0.5 bg-[#403b33]/10 border border-[#403b33]/20 text-[#403b33]">
            {tech}
          </span>
        ))}
      </div>

      <div class="mt-auto">
        {hasLinks ? (
          <div class="flex flex-col gap-2.5">
            {project.demoUrl && (
              <a
                href={project.demoUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="w-full inline-flex items-center justify-center px-4 py-2 bg-[#403b33] text-[#e7e2d8] border-2 border-black font-mono font-black text-[10px] md:text-xs uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px] transition-all"
              >
                VER_SITIO
                <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path>
                </svg>
              </a>
            )}

            {project.githubUrl && (
              <a
                href={project.githubUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="w-full inline-flex items-center justify-center px-4 py-2 bg-[#eae7dc] text-[#403b33] border-2 border-black font-mono font-bold text-[10px] md:text-xs uppercase hover:bg-white transition-all shadow-[3px_3px_0px_0px_rgba(0,0,0,1)]"
              >
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C6.477 2 2 6.484 2 12.017 2 16.216 4.672 19.743 8.309 20.982c.5.094.68-.22.68-.485 0-.237-.008-.865-.013-1.698-2.69.586-3.253-1.3-3.253-1.3-.44-1.116-1.07-1.413-1.07-1.413-.876-.59.066-.58.066-.58.97.067 1.488.995 1.488.995.86 1.486 2.27 1.056 2.82.806.085-.628.337-1.056.617-1.295-2.15-.24-4.416-1.075-4.416-4.79 0-1.06.377-1.925 1-2.608-.1-.24-.435-1.238.096-2.573 0 0 .81-.26 2.642.987.77-.215 1.58-.322 2.39-.327.81.005 1.62.112 2.39.327 1.832-1.247 2.64-1 2.64-1 .53 1.335.2 2.333.1 2.573.623.683 1 1.548 1 2.608 0 3.722-2.27 4.545-4.425 4.786.357.307.678.915.678 1.855 0 1.336-.012 2.417-.012 2.748 0 .268.18.58.688.484C19.333 19.73 22 16.208 22 12.017 22 6.484 17.522 2 12 2Z" />
                </svg>
                VER_CODIGO
              </a>
            )}
          </div>
        ) : (
          <div class="w-full py-3 bg-[#403b33]/5 border-2 border-dashed border-[#403b33]/20 flex items-center justify-center gap-2 grayscale opacity-50">
            <span class="text-[#403b33] text-[9px] font-mono font-black uppercase tracking-widest italic">Encrypted // Access_Denied</span>
          </div>
        )}
      </div>
    </div>
  </div>
</article>